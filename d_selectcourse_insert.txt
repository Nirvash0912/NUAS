//d

//use procedure

create procedure select_course (IN coursecode char(8), IN StudentId int(11), IN year int(11), IN semester char(2)) 
Begin 

declare status int default 0;

start transaction;
//Max_enrollment
if coursecode in (select c.uoscode from uosoffering as c where c.enrollment >= c.maxenrollment) then set message = 1;


//prerequiste
elseif coursecode not in (select r.uoscode from requires as r where r.prerequoscode in (select t.uoscode from transcript as t where t.studid =StudentId and t.grade = 'P')) then set message = 2; select uoscode,uosname from unitofstudy where uoscode in (select r.prereqUosCode from requires as r where r.uoscode = coursecode); 

else
set message = 3;
Insert into transcript values (StudentID,courseCode,year,semester,'null');
update uosoffering set enrollment = enrollment+1 where uoscode = coursecode; 

select message;

end if;

End



//e








